Job ID: 65764
Job Name: cnn_training
Node: b-31-12
GPU: 0
Start Time: Tue Sep 30 09:41:30 PM EDT 2025
Working Directory: /scratch/cx2275/CNN_From_Scratch
Starting Singularity container...
Updating 29cb982..8a44fd0
Fast-forward
 cnn_from_scratch_empty.py | 151 +++++++++++++++++++++++++---------------------
 run_cnn.sbatch            |  56 +++++++++++++++++
 tests.py                  |   2 +-
 3 files changed, 139 insertions(+), 70 deletions(-)
 create mode 100644 run_cnn.sbatch
Python version: Python 3.10.18
PyTorch version: 2.6.0
CUDA available: True
GPU count: 1
GPU name: NVIDIA L4
==========================
Running tests...
Device: cuda
Training set: torch.Size([48000, 1, 28, 28]), torch.Size([48000])
Validation set: torch.Size([12000, 1, 28, 28]), torch.Size([12000])
Test set: torch.Size([10000, 1, 28, 28]), torch.Size([10000])
Device: cuda

[Linear] forward/backward numeric grad...
  max |dL/dx (num - analytic)|: 6.458163261413574e-05
  max |dL/dW (num - analytic)|: 5.84721565246582e-05
  max |dL/db (num - analytic)|: 0.00011307001113891602
  PASS

[ReLU] forward/backward numeric grad...
  max |dL/dx| diff: 0.00018703937530517578
  PASS

[CrossEntropy] forward/backward numeric grad wrt logits...
  max |dL/dlogits| diff: 0.00014224275946617126
  PASS

[Conv2D] forward shape check...
  PASS

[Conv2D] backward numeric grads (sampled)...
  max |dL/dx| diff: 0.0005117803812026978
  max |dL/dW| diff: 0.0006861686706542969
  PASS

[MaxPool2D] forward vs F.max_pool2d...
  max |y - y_ref|: 0.0
  PASS

[MaxPool2D] backward numeric grads...
  max |dL/dx| diff: 4.225969314575195e-05
  PASS

[E2E] small CNN forward shape...
  PASS

[E2E] tiny training sanity: loss should drop...
  epoch1: loss=2.2131, acc=0.039
  epoch2: loss=1.9477, acc=0.266
  PASS

ALL TESTS PASSED (within numeric tolerances)
==========================
Tests completed. Starting CNN training...
Device: cuda
Training set: torch.Size([48000, 1, 28, 28]), torch.Size([48000])
Validation set: torch.Size([12000, 1, 28, 28]), torch.Size([12000])
Test set: torch.Size([10000, 1, 28, 28]), torch.Size([10000])
CNN from Scratch - Assignment
==================================================
Building CNN...
Starting training...
Total parameters: 9098
GPU memory allocated: 210.6 MB
GPU memory reserved: 212.0 MB

=== Starting Epoch 1/5 ===
Epoch 1/5: train_loss=1.9249 train_acc=0.4271 val_loss=1.3378 val_acc=0.6769

=== Starting Epoch 2/5 ===
Epoch 2/5: train_loss=0.8459 train_acc=0.7806 val_loss=0.5704 val_acc=0.8421

=== Starting Epoch 3/5 ===
Epoch 3/5: train_loss=0.4740 train_acc=0.8664 val_loss=0.4213 val_acc=0.8795

=== Starting Epoch 4/5 ===
Epoch 4/5: train_loss=0.3759 train_acc=0.8911 val_loss=0.3640 val_acc=0.8921

=== Starting Epoch 5/5 ===
Epoch 5/5: train_loss=0.3278 train_acc=0.9045 val_loss=0.3222 val_acc=0.9076

Training curves saved to training_curves.png

Final Test Results: loss 0.2916 | acc 0.9173
Training completed at:  Tue Sep 30 21:43:20 EDT 2025
Job completed at: Tue Sep 30 09:43:20 PM EDT 2025
