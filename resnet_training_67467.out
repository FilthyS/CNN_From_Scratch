Job ID: 67467
Job Name: resnet_training
Node: b-31-7
GPU: 0
Start Time: Tue Oct  7 12:38:36 PM EDT 2025
Working Directory: /scratch/cx2275/CNN_From_Scratch
Starting Singularity container...
Python version: Python 3.10.18
PyTorch version: 2.6.0
CUDA available: True
GPU count: 1
GPU name: NVIDIA L4
==========================
Starting ResNet-18 fine-tuning on EMNIST...
Device: cuda
GPU: NVIDIA L4
Image size: torch.Size([3, 224, 224])
Dataset length: 697932
Training dataset size: 628138
Validation dataset size: 69794
Test dataset size: 116323
Batch size: 128
Output directory: ./output_20251007_123938

======================================================================
REGIME 1: LINEAR PROBE (Freeze backbone, train only FC)
======================================================================
Frozen backbone. Trainable params: 0.03M

======================================================================
Training Regime: Regime 1: Linear Probe
Mixed Precision (AMP): Enabled
Early Stopping: Enabled (patience=5)
======================================================================
Epoch [1/15] LR: 0.010000 | Train Loss: 0.8154, Train Acc: 76.11% | Val Loss: 0.6665, Val Acc: 78.93%
Epoch [2/15] LR: 0.010000 | Train Loss: 0.6547, Train Acc: 79.39% | Val Loss: 0.6519, Val Acc: 78.73%
Epoch [3/15] LR: 0.010000 | Train Loss: 0.6328, Train Acc: 79.93% | Val Loss: 0.6228, Val Acc: 79.99%
Epoch [4/15] LR: 0.010000 | Train Loss: 0.6240, Train Acc: 80.14% | Val Loss: 0.6416, Val Acc: 78.90%
Epoch [5/15] LR: 0.001000 | Train Loss: 0.6191, Train Acc: 80.25% | Val Loss: 0.6134, Val Acc: 80.27%
Epoch [6/15] LR: 0.001000 | Train Loss: 0.5857, Train Acc: 81.47% | Val Loss: 0.5949, Val Acc: 81.14%
Epoch [7/15] LR: 0.001000 | Train Loss: 0.5845, Train Acc: 81.57% | Val Loss: 0.5964, Val Acc: 81.09%
Epoch [8/15] LR: 0.001000 | Train Loss: 0.5843, Train Acc: 81.57% | Val Loss: 0.5950, Val Acc: 81.05%
Epoch [9/15] LR: 0.001000 | Train Loss: 0.5842, Train Acc: 81.62% | Val Loss: 0.5967, Val Acc: 81.08%
Epoch [10/15] LR: 0.000100 | Train Loss: 0.5841, Train Acc: 81.60% | Val Loss: 0.5954, Val Acc: 81.11%
Epoch [11/15] LR: 0.000100 | Train Loss: 0.5809, Train Acc: 81.72% | Val Loss: 0.5932, Val Acc: 81.21%
Epoch [12/15] LR: 0.000100 | Train Loss: 0.5809, Train Acc: 81.74% | Val Loss: 0.5915, Val Acc: 81.26%
Epoch [13/15] LR: 0.000100 | Train Loss: 0.5806, Train Acc: 81.76% | Val Loss: 0.5923, Val Acc: 81.23%
Epoch [14/15] LR: 0.000100 | Train Loss: 0.5805, Train Acc: 81.74% | Val Loss: 0.5935, Val Acc: 81.25%
Epoch [15/15] LR: 0.000010 | Train Loss: 0.5808, Train Acc: 81.75% | Val Loss: 0.5921, Val Acc: 81.26%

Training completed in 90.69 minutes
Epochs trained: 15/15
Best validation accuracy: 81.26%

Regime 1 Test Results:
  Accuracy: 81.30%
  Precision: 0.7110
  Recall: 0.6568
  F1-Score: 0.6656
Saved: ./output_20251007_123938/regime1_linear_probe/training_curves.png
Saved: ./output_20251007_123938/regime1_linear_probe/confusion_matrix.png
Saved: ./output_20251007_123938/regime1_linear_probe/results_summary.txt

======================================================================
REGIME 2: PARTIAL UNFREEZE (Unfreeze layer4 + FC from start)
======================================================================
Unfroze layer4. Trainable params: 11.21M

======================================================================
Training Regime: Regime 2: Partial Unfreeze
Mixed Precision (AMP): Enabled
Early Stopping: Enabled (patience=5)
Learning Rate Warmup: 3 epochs
======================================================================
Epoch [1/20] LR: 0.000667 | Train Loss: 0.7380, Train Acc: 80.12% | Val Loss: 0.4115, Val Acc: 85.81%
Epoch [2/20] LR: 0.001000 | Train Loss: 0.3810, Train Acc: 86.46% | Val Loss: 0.3567, Val Acc: 86.90%
Epoch [3/20] LR: 0.001000 | Train Loss: 0.3462, Train Acc: 87.23% | Val Loss: 0.3403, Val Acc: 87.34%
Epoch [4/20] LR: 0.000994 | Train Loss: 0.3261, Train Acc: 87.82% | Val Loss: 0.3321, Val Acc: 87.43%
Epoch [5/20] LR: 0.000976 | Train Loss: 0.3132, Train Acc: 88.20% | Val Loss: 0.3230, Val Acc: 87.93%
Epoch [6/20] LR: 0.000946 | Train Loss: 0.3036, Train Acc: 88.49% | Val Loss: 0.3239, Val Acc: 87.74%
Epoch [7/20] LR: 0.000905 | Train Loss: 0.2955, Train Acc: 88.74% | Val Loss: 0.3174, Val Acc: 88.13%
Epoch [8/20] LR: 0.000854 | Train Loss: 0.2877, Train Acc: 89.05% | Val Loss: 0.3175, Val Acc: 88.01%
Epoch [9/20] LR: 0.000794 | Train Loss: 0.2801, Train Acc: 89.25% | Val Loss: 0.3204, Val Acc: 87.95%
Epoch [10/20] LR: 0.000727 | Train Loss: 0.2727, Train Acc: 89.53% | Val Loss: 0.3169, Val Acc: 88.09%
Epoch [11/20] LR: 0.000655 | Train Loss: 0.2648, Train Acc: 89.82% | Val Loss: 0.3192, Val Acc: 87.98%
Epoch [12/20] LR: 0.000578 | Train Loss: 0.2567, Train Acc: 90.09% | Val Loss: 0.3170, Val Acc: 88.08%

Early stopping triggered at epoch 12
No improvement for 5 epochs

Training completed in 108.44 minutes
Epochs trained: 12/20
Best validation accuracy: 88.13%

Regime 2 Test Results:
  Accuracy: 88.14%
  Precision: 0.8246
  Recall: 0.7647
  F1-Score: 0.7706
Saved: ./output_20251007_123938/regime2_partial_unfreeze/training_curves.png
Saved: ./output_20251007_123938/regime2_partial_unfreeze/confusion_matrix.png
Saved: ./output_20251007_123938/regime2_partial_unfreeze/results_summary.txt

======================================================================
GENERATING COMPARISON REPORTS
======================================================================
Saved: ./output_20251007_123938/regime_comparison.png
Saved: ./output_20251007_123938/regime_comparison_summary.txt

================================================================================
FINAL COMPARISON TABLE
================================================================================
Regime                         Test Acc     Params (M)   Epochs     Time (min)  
--------------------------------------------------------------------------------
Regime 1: Linear Probe              81.30%       0.03M       15      90.69
Regime 2: Partial Unfreeze          88.14%      11.21M       12     108.44
================================================================================

Accuracy improvement (Regime 2 - Regime 1): +6.85%
Additional training time: +17.74 min
Additional trainable params: +11.18M

======================================================================
TRAINING COMPLETE
Results saved to: ./output_20251007_123938/
======================================================================
Training completed at:  Tue Oct 7 16:00:55 EDT 2025
