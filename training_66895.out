Job ID: 66895
Job Name: resnet_training
Node: b-19-14
GPU: 0
Start Time: Mon Oct  6 06:44:39 PM EDT 2025
Working Directory: /scratch/cx2275/CNN_From_Scratch
Starting Singularity container...
Already up to date.
Python version: Python 3.10.18
PyTorch version: 2.6.0
CUDA available: True
GPU count: 1
GPU name: NVIDIA A100-SXM4-40GB
==========================
Running tests...
Device: cuda
Training set: torch.Size([48000, 1, 28, 28]), torch.Size([48000])
Validation set: torch.Size([12000, 1, 28, 28]), torch.Size([12000])
Test set: torch.Size([10000, 1, 28, 28]), torch.Size([10000])
Device: cuda

[Linear] forward/backward numeric grad...
  max |dL/dx (num - analytic)|: 6.458163261413574e-05
  max |dL/dW (num - analytic)|: 5.848705768585205e-05
  max |dL/db (num - analytic)|: 0.00011307001113891602
  PASS

[ReLU] forward/backward numeric grad...
  max |dL/dx| diff: 0.00018703937530517578
  PASS

[CrossEntropy] forward/backward numeric grad wrt logits...
  max |dL/dlogits| diff: 0.00014224275946617126
  PASS

[Conv2D] forward shape check...
  PASS

[Conv2D] backward numeric grads (sampled)...
  max |dL/dx| diff: 0.0005117803812026978
  max |dL/dW| diff: 0.0006861686706542969
  PASS

[MaxPool2D] forward vs F.max_pool2d...
  max |y - y_ref|: 0.0
  PASS

[MaxPool2D] backward numeric grads...
  max |dL/dx| diff: 4.225969314575195e-05
  PASS

[E2E] small CNN forward shape...
  PASS

[E2E] tiny training sanity: loss should drop...
  epoch1: loss=2.1982, acc=0.039
  epoch2: loss=1.9359, acc=0.273
  PASS

ALL TESTS PASSED (within numeric tolerances)
==========================
Tests completed. Starting CNN training...
Device: cuda
Training set: torch.Size([48000, 1, 28, 28]), torch.Size([48000])
Validation set: torch.Size([12000, 1, 28, 28]), torch.Size([12000])
Test set: torch.Size([10000, 1, 28, 28]), torch.Size([10000])
CNN from Scratch - Assignment
==================================================
Building CNN...
Starting training...
Total parameters: 9098
GPU memory allocated: 210.6 MB
GPU memory reserved: 212.0 MB

=== Starting Epoch 1/5 ===
Epoch 1/5: train_loss=1.9249 train_acc=0.4271 val_loss=1.3378 val_acc=0.6769

=== Starting Epoch 2/5 ===
Epoch 2/5: train_loss=0.8459 train_acc=0.7805 val_loss=0.5704 val_acc=0.8421

=== Starting Epoch 3/5 ===
Epoch 3/5: train_loss=0.4740 train_acc=0.8664 val_loss=0.4213 val_acc=0.8794

=== Starting Epoch 4/5 ===
Epoch 4/5: train_loss=0.3759 train_acc=0.8911 val_loss=0.3640 val_acc=0.8921

=== Starting Epoch 5/5 ===
Epoch 5/5: train_loss=0.3278 train_acc=0.9046 val_loss=0.3222 val_acc=0.9076

Training curves saved to training_curves_20251006_184635.png

Final Test Results: loss 0.2916 | acc 0.9174
CNN Training completed at:  Mon Oct 6 18:46:37 EDT 2025
\n==========================
Starting ResNet-18 fine-tuning on EMNIST...
Device: cuda
GPU: NVIDIA A100-SXM4-40GB
Image size: torch.Size([3, 224, 224])
Dataset length: 697932
Training dataset size: 628138
Validation dataset size: 69794
Test dataset size: 116323
Batch size: 128
Output directory: ./output_20251006_184650

======================================================================
REGIME 1: LINEAR PROBE (Freeze backbone, train only FC)
======================================================================
Frozen backbone. Trainable params: 0.03M

======================================================================
Training Regime: Regime 1: Linear Probe
Mixed Precision (AMP): Enabled
Early Stopping: Enabled (patience=5)
======================================================================
Epoch [1/15] LR: 0.010000 | Train Loss: 0.8154, Train Acc: 76.10% | Val Loss: 0.6666, Val Acc: 78.93%
Epoch [2/15] LR: 0.010000 | Train Loss: 0.6547, Train Acc: 79.38% | Val Loss: 0.6518, Val Acc: 78.75%
Epoch [3/15] LR: 0.010000 | Train Loss: 0.6328, Train Acc: 79.93% | Val Loss: 0.6228, Val Acc: 80.00%
Epoch [4/15] LR: 0.010000 | Train Loss: 0.6240, Train Acc: 80.14% | Val Loss: 0.6416, Val Acc: 78.90%
Epoch [5/15] LR: 0.001000 | Train Loss: 0.6191, Train Acc: 80.25% | Val Loss: 0.6134, Val Acc: 80.27%
Epoch [6/15] LR: 0.001000 | Train Loss: 0.5857, Train Acc: 81.47% | Val Loss: 0.5949, Val Acc: 81.15%
Epoch [7/15] LR: 0.001000 | Train Loss: 0.5845, Train Acc: 81.56% | Val Loss: 0.5964, Val Acc: 81.10%
Epoch [8/15] LR: 0.001000 | Train Loss: 0.5843, Train Acc: 81.57% | Val Loss: 0.5950, Val Acc: 81.04%
Epoch [9/15] LR: 0.001000 | Train Loss: 0.5842, Train Acc: 81.61% | Val Loss: 0.5967, Val Acc: 81.08%
Epoch [10/15] LR: 0.000100 | Train Loss: 0.5841, Train Acc: 81.60% | Val Loss: 0.5954, Val Acc: 81.12%
Epoch [11/15] LR: 0.000100 | Train Loss: 0.5809, Train Acc: 81.73% | Val Loss: 0.5932, Val Acc: 81.20%
Epoch [12/15] LR: 0.000100 | Train Loss: 0.5809, Train Acc: 81.74% | Val Loss: 0.5915, Val Acc: 81.25%
Epoch [13/15] LR: 0.000100 | Train Loss: 0.5806, Train Acc: 81.76% | Val Loss: 0.5923, Val Acc: 81.23%
Epoch [14/15] LR: 0.000100 | Train Loss: 0.5805, Train Acc: 81.74% | Val Loss: 0.5935, Val Acc: 81.24%
Epoch [15/15] LR: 0.000010 | Train Loss: 0.5808, Train Acc: 81.74% | Val Loss: 0.5921, Val Acc: 81.25%

Training completed in 88.59 minutes
Epochs trained: 15/15
Best validation accuracy: 81.25%
ResNet Training completed at:  Mon Oct 6 20:15:28 EDT 2025
[main 28ac09e] added
 Committer: Sheldon Xie <cx2275@cs001.hpc.nyu.edu>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 4 files changed, 170 insertions(+)
 create mode 100644 training_66895.err
 create mode 100644 training_66895.out
 create mode 100644 training_curves_20251006_184635.png
Job completed at: Mon Oct  6 08:15:28 PM EDT 2025
